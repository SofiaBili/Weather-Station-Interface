<!DOCTYPE html>
<html>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
<script src="https://unpkg.com/chart.js@2.8.0/dist/Chart.bundle.js"></script>
  <script src="https://unpkg.com/chartjs-gauge@0.3.0/dist/chartjs-gauge.js"></script>
<head>
	<title>Weather Station</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

	<!-- Bootstrap Font Icon CSS -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" />
	<link rel="stylesheet" href="sidenav.css">

</head>

<body>
	<script>
		window.onload = function () {
			var xAllValues = [50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150];
			var yAllValues = [7, 8, 8, 9, 9, 9, 10, 11, 14, 14, 15];
			var xRainValues = [1, 2, 7, 8, 9, 10];
			var yRainValues = [7, 8, 8, 9, 9, 9];
			
			var y1Values = [7, 8, 8, 9, 9, 9];
			var y2Values = [7, 4, 8, 2, 9, 7];
			var y3Values = [1, 8, 6, 12, 9, 9];
			var y4Values = [6, 8, 3, 1, 3, 7];
			
			var colors = [ '#2685CB', '#4AD95A', '#FEC81B', '#FD8D14', '#CE00E6', '#4B4AD3'];
			
			//Gauge Variables
			var curValue = 2;
			var curMinValue = 0;
			var curLim = [1,2,3,4];

			//Gauge Functions
			var chartName = document.getElementById('temp').getContext('2d');//Temperature
			gFunction(chartName, curValue, curMinValue, curLim, "Temperature");

			var chartName = document.getElementById('hum').getContext('2d');//Humidity
			gFunction(chartName, curValue, curMinValue, curLim, "Humidity");
			
			var chartName = document.getElementById('bar').getContext('2d');//Barometric pressure
			gFunction(chartName, curValue, curMinValue, curLim, "Barometric pressure");
			
			//Creation of Dynamic Array
			var datasetdata0 = [];
			var datasetdata1 = [];
			var datasetdata2 = [];
			var datasetdata3 = [];
			var datasetdata4 = [];
			var dataarray = [y1Values,y2Values,y3Values];
			var dataarray2 = [y1Values,y2Values,y3Values, y4Values];
			

			var chartName = document.getElementById('bme');//BME280
			DynamicLineFunction(chartName,xRainValues,fillDataset(dataarray,datasetdata0),"Temperature,Humidity and Barometric pressure");
			
			//var chartName = document.getElementById('bme');//BME280
			//mulLineFunction(chartName,xRainValues,y1Values,y2Values,y3Values,"Temperature,Humidity and Barometric pressure");
			
			//Line Functions
			var chartName = document.getElementById('dust');//Dust
			cFunction(chartName, xRainValues, yRainValues, "Dust");

			var chartName = document.getElementById('rain');//Rain
			cFunction(chartName, xRainValues, yRainValues, "Rain");

			var chartName = document.getElementById('mq2');//MQ2
			DynamicLineFunction(chartName,xRainValues,fillDataset(dataarray,datasetdata1),"MQ2");

			var chartName = document.getElementById('mq3');//MQ3
			DynamicLineFunction(chartName,xRainValues,fillDataset(dataarray,datasetdata2),"MQ3");

			var chartName = document.getElementById('mq4');//MQ4
			DynamicLineFunction(chartName,xRainValues,fillDataset(dataarray,datasetdata3),"MQ4");

			var chartName = document.getElementById('mq135');//MQ135
			DynamicLineFunction(chartName,xRainValues,fillDataset(dataarray2,datasetdata4),"MQ135");

			var chartName = document.getElementById('aq');//Air Quality
			cFunction(chartName, xRainValues, yRainValues, "Air Quality");
			
			function fillDataset(dataarray, datasetdata){
				for (var i=0; i<dataarray.length; i++) {
					datasetdata[i] = {
						label:"Test " + i,
						data: dataarray[i],
						fill: false,
						backgroundColor: colors[i],
						borderColor: colors[i],
					}
				}
				return datasetdata;
			}
			function cFunction(chartName, xValues, yValues, chartText) {
				var chart = new Chart(chartName, {
					type: "line",
					data: {
						labels: xValues,
						datasets: [{
							fill: false,
							lineTension: 0,
							backgroundColor: "rgba(0,0,255,1.0)",
							borderColor: "rgba(0,0,255,0.1)",
							data: yValues
						}]
					},
					options: {
						legend: { display: false },
						title: {
							display: true,
							text: chartText
						}
					}
				});
				chart.render();
			}
			
			/*function mulLineFunction(chartName,xValues,y1Values,y2Values,y3Values,chartText) {
				var chart = new Chart(chartName, {
					type: "line",
					data: {
						labels: xValues,
						datasets: [
							{
							  label: 'Temperature',
							  data:y1Values ,
							  fill: false,
							  borderColor: "rgba(0,0,255,0.1)",
							  backgroundColor: "rgba(0,0,255,1.0)",
							},
							{
							  label: 'Humidity',
							  data:y2Values,
							  fill: false,
							  borderColor: "rgba(0,255,0,0.1)",
							  backgroundColor: "rgba(0,255,0,1.0)",
							},
							{
							  label: 'Barometric',
							  data:y3Values ,
							  fill: false,
							  borderColor: "rgba(255,0,0,0.1)",
							  backgroundColor: "rgba(255,0,0,1.0)",
							}
						  ]
					},
					options: {
						legend: { display: false },
						title: {
							display: true,
							text: chartText
						}
					}
				});
				chart.render();
			}*/
			
			function DynamicLineFunction(chartName,xValues,datasetdata,chartText) {
				var chart = new Chart(chartName, {
					type: "line",
					data: {
						labels: xValues,
						datasets: datasetdata
					},
					options: {
						legend: {
							position: 'top',
						  },
						title: {
							display: true,
							text: chartText
						}
					}
				});
				chart.render();
			}			
		
			function gFunction(chartName, curValue, curMinValue, curLim, chartText) {
				var chart = new Chart(chartName, {
					type: "gauge",
					data: {
						datasets: [{
							value: curValue,
							minValue: curMinValue,
							backgroundColor: ['green', 'yellow', 'orange', 'red'],
							data: curLim,
						}]
					},
					options: {
						needle: {
						  radiusPercentage: 12,
						  widthPercentage: 3.0,
						  lengthPercentage: 80,
						  color: 'rgba(0, 0, 0, 1)'
						},
						valueLabel: {
						  display: true,
						  formatter: (value) => {
							return Math.round(value);
						  },
						  color: 'rgba(255, 255, 255, 1)',
						  backgroundColor: 'rgba(0, 0, 0, 1)',
						  borderRadius: 5,
						  padding: {
							top: 10,
							bottom: 10
						  }
						},
						title: {
							display: true,
							text: chartText
						}
					  }
				});
				chart.render();
		}
	}
	</script>
	<div class="sidenav">
		<a href="map.html"><i class="bi bi-map-fill"></i></a>
		<a href="data.html" class="current"><i class="bi bi-cloud-fill"></i></a>
	</div>

	<div class="main">
		<div class="content-area">
			<div class="container-fluid">
				<div class="row">
					<div class="col-sm-6" style="background-color:white;">
						<h2>Weather Sensors</h2>
						<div class="row">
							<div class="col-sm-6"><canvas id="temp"></canvas></div>
							<div class="col-sm-6"><canvas id="hum"></div>
							<div class="col-sm-6"><canvas id="bar"></div>
						</div>
						<div class="row">
							<div class="col-sm-12"><canvas id="bme"></canvas></div>
						</div>
						<div class="row">
							<div class="col-sm-12"><canvas id="dust"></canvas></div>
						</div>
						<div class="row">
							<div class="col-sm-12"><canvas id="rain"></canvas></div>
						</div>
						<!--<div class="row">
							<div class="col-sm-6"><canvas id="dust"></canvas></div>
							<div class="col-sm-6"><canvas id="rain"></canvas></div>
						</div>-->
					</div>
					<div class="col-sm-6" style="background-color:white;">
						<h2>Air Quality Sensors</h2>
						<div class="row">
							<div class="col-sm-12"><canvas id="mq2"></canvas></div>
						</div>
						<div class="row">
							<div class="col-sm-12"><canvas id="mq3"></canvas></div>
						</div>
						<div class="row">
							<div class="col-sm-12"><canvas id="mq4"></canvas></div>
						</div>
						<div class="row">
							<div class="col-sm-12"><canvas id="mq135"></canvas></div>
						</div>
						<!--
							<div class="row">
							<div class="col-sm-6"><canvas id="mq2"></canvas></div>
							<div class="col-sm-6"><canvas id="mq3"></canvas></div>
						</div>
						<div class="row">
							<div class="col-sm-6"><canvas id="mq4"></canvas></div>
							<div class="col-sm-6"><canvas id="mq135"></canvas></div>
						</div>
					-->
						<div class="row">
							<div class="col-sm-12"><canvas id="aq"></canvas></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>